<div class="flex flex-col h-full">
  <div class="flex-1 overflow-y-auto">
    <%= if live_flash(@flash, :error) do %>
      <div class="text-red-600 mb-2"><%= live_flash(@flash, :error) %></div>
    <% end %>

    <div :if={@loading} class="mt-2 text-gray-500">Generating...</div>

    <div :if={@chart_spec} id="chart-container" class="mt-6" phx-hook="VegaLiteChart" phx-update="ignore" data-spec={@chart_spec}>
    </div>
  </div>

  <%= if @collapsed do %>
    <div class="border-t bg-white p-4 fixed bottom-0 inset-x-0">
      <div class="max-w-4xl mx-auto flex items-center justify-between rounded-xl border border-gray-300 bg-white shadow-sm px-4 py-2">
        <div class="flex-1 text-sm text-gray-700 truncate" aria-label="Collapsed prompt"><%= @prompt %></div>
        <button type="button" phx-click="expand_input" aria-label="Expand input" class="ml-2 rounded-full bg-black text-white text-xs px-3 py-1">+</button>
      </div>
    </div>
  <% else %>
    <form phx-submit="generate" class="border-t bg-white p-4 fixed bottom-0 inset-x-0">
      <div class="max-w-4xl mx-auto rounded-xl border border-gray-300 shadow-sm bg-white px-4 py-2 transition-all">
        <div class="flex items-center justify-between">
          <textarea name="prompt" id="prompt" rows="1" phx-hook="AutoGrow" placeholder="Describe a task" aria-label="Task description" class="flex-1 resize-none bg-transparent focus:outline-none placeholder-gray-400 overflow-hidden"></textarea>
          <button type="submit" aria-label="Submit task" class="ml-2 rounded-full bg-black text-white text-sm px-3 py-1">Go</button>
        </div>
        <div class="flex space-x-2 border-t border-gray-200 pt-1 mt-2 text-xs text-gray-500">
          <button type="button" class="px-2 py-1 hover:text-black">[📁] stephenszpak/nl-dash...</button>
          <button type="button" class="px-2 py-1 hover:text-black">[🔀] main</button>
          <button type="button" class="px-2 py-1 hover:text-black">[📦] 1x</button>
        </div>
      </div>
    </form>
  <% end %>
</div>

